#!/bin/bash

FILES=""

# Shakespeare's collected works
URL="https://www.gutenberg.org/cache/epub/100/pg100.txt"
FILE="shakespeare.txt"
rm -f $FILE
echo "Reading $URL writing $FILE..."
curl $URL -o $FILE
FILES="${FILES} ${FILE}"

# Gutenberg EBook of Webster's Unabridged Dict
echo
URL="https://www.gutenberg.org/cache/epub/29765/pg29765.txt"
FILE="dict.txt"
rm -f $FILE
echo "Reading $URL writing $FILE..."
curl $URL -o $FILE
FILES="${FILES} ${FILE}"

# URLS
echo
URL="http://data.law.di.unimi.it/webdata/it-2004/it-2004.urls.gz"
FILE="url.txt.gz"
rm -f $FILE
OUTFILE="url.txt"
echo "Reading $URL writing $FILE..."
curl $URL -o $FILE
rm -f ${OUTFILE} 
gunzip ${FILE}
FILES="${FILES} ${OUTFILE}"

# Random strings avg-len 20 with std-dev 3
echo
N=10000000
FILE="rand.txt"
echo "Generating $N random strings in $FILE ..."
../benchmark/scripts/keygen $N 20 gauss 3 1>$FILE
FILES="${FILES} ${FILE}"

MANIFEST=""

# convert text files to binary format for everything except CoCo
# CoCo will read text files not binary format
for f in $FILES
do
  echo
  MANIFEST="$MANIFEST $f"

  OUTFILE="${f%%.txt}.bin"
  echo "converting text file $f to $OUTFILE..."
  rm -f $OUTFILE
  ./generator.tsk -m convert-text -i $f -o $OUTFILE
  MANIFEST="$MANIFEST $OUTFILE"

  OUTFILE="${f%%.txt}.cstr.bin"
  echo "converting text file $f to $OUTFILE as c-strings..."
  rm -f $OUTFILE
  ./generator.tsk -m convert-text -i $f -o $OUTFILE -t
  MANIFEST="$MANIFEST $OUTFILE"

  SORTED="${f}.sorted"
  echo "unique sorting $f..."
  sort -u $f > $SORTED
  MANIFEST="$MANIFEST $SORTED"

  OUTFILE="${f%%.txt}.sorted.bin"
  echo "converting text file $SORTED to $OUTFILE..."
  rm -f $OUTFILE
  ./generator.tsk -m convert-text -i $SORTED -o $OUTFILE
  MANIFEST="$MANIFEST $OUTFILE"

  OUTFILE="${f%%.txt}.sorted.cstr.bin"
  echo "converting text file $SORTED to $OUTFILE as c-strings..."
  rm -f $OUTFILE
  ./generator.tsk -m convert-text -i $SORTED -o $OUTFILE -t
  MANIFEST="$MANIFEST $OUTFILE"
done

echo
echo "Dataset Files"
echo "======================================================================="
ls -ald $MANIFEST
